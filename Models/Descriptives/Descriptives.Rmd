Descriptive statistics
=================================================
This report tracks down the creation of graphs for basic descriptive statistics in the NLSY97 religiosity data as defined by the extract NLSY97_Religiosity_20042014.  


<!--  Set the working directory to the repository's base directory; this assumes the report is nested inside of only one directory.-->
```{r, echo=F, message=F} 
opts_knit$set(root.dir='../../')  #Don't combine this call with any other chunk -especially one that uses file paths.

```


<!-- Set the report-wide options, and point to the external code file. -->
```{r set_options, echo=F, message=F}
require(knitr)
# getwd()
opts_chunk$set(
  results='show', 
  message = TRUE,
  comment = NA, 
  tidy = FALSE,
  fig.height = 4, 
  fig.width = 5.5, 
  out.width = "565px",
  fig.path = 'figure_rmd/',     
  dev = "png",
#   fig.path = 'figure_pdf/',     
#   dev = "pdf",
  dpi = 400
)
echoChunks <- FALSE
options(width=120) #So the output is 50% wider than the default.
read_chunk("./Models/Descriptives/Descriptives.R") # the file to which knitr calls for the chunks
```

```{r DeclareGlobals, echo=echoChunks, message=FALSE}
```

```{r LoadPackages, echo=echoChunks, message=F}
```

```{r LoadData, echo=echoChunks, message=FALSE}

```

First we load the data, specifically the dataset **dsL**, obtained by the report [Derive_dsL_from_Extract](./Data/Derive_dsL_from_Extract.md). 

### Figure 1 : View of the initial **dsL** dataset
<img link src="./figure_rmd/dsL_view.png" alt="View of dsL" style="width:900px;"/>  
The view shows all the measurements taken from one individual (id=1) for the selected variables (columns). All datasets for modeling are derived by subsetting the columns of this one. However, it's easier to see the overall data layout with expressing **dsL** as a slice of Cattell's databox, showing variables across occasions.

### Figure 2 : **dsL** re-expressed as a Cattell's datacube slice
<img link src="./figure_rmd/variables_layout.png" alt="Databox slice" style="width:800px;"/>
Observed that this view is obtained by transposing the columns in Figure 1, except for **year**, which values are used as symbols of intersections of variales and occasions.

```{r TweakData, echo=echoChunks, message=FALSE}
```

```{r sample_1997, echo=echoChunks, message=FALSE}
p<-ggplot(subset(ds,year==1997), aes(x=sample))
p<-p+geom_bar() 
# p<-p+geom_text(aes(x=sample,y=,label=)) 
p
```

```{r sex_1997, echo=echoChunks, message=FALSE}
p<-ggplot(subset(ds,year==1997), aes(x=sex))
p<-p+geom_bar()
p
```

```{r race_1997, echo=echoChunks, message=FALSE}
p<-ggplot(subset(ds,year==1997), aes(x=race))
p<-p+geom_bar() 
p
```

```{r bmonth_1997, echo=echoChunks, message=FALSE}
# str(ds$bmonth)
p<-ggplot(subset(ds,year==1997), aes(x=bmonth))
p<-p+geom_bar() 
# p<-p+coord_flip()
p
```

```{r byear_1997, echo=echoChunks, message=FALSE}
# str(ds$byear)
p<-ggplot(subset(ds,year==1997), aes(x=factor(byear)))
p<-p+geom_bar() 
p
```

```{r attendPR_1997, echo=echoChunks, message=FALSE}
ds<-dsL
attcol8<-c("blue3","blue","lightblue", "snow", "lightpink", "red" ,"red3", "red4","black")
attcol3<-c("blue2","blue2","snow", "snow", "snow", "red2" ,"red2", "red2")

# ds$attendPR<-factor(ds$attendPR, levels =(rev(levels(ds$attendPR))))
# attlevels<-rev((levels(ds$attendPR)))
p<-ggplot(subset(ds,year==1997), aes(x=attendPR, fill=attendPR))
p<-p+geom_bar()
p<-p+scale_fill_manual(values = attcol8,
                       labels = attlevels,
                         name = "Response categories" )
# p<-p+scale_color_manual(values=attcol8,breaks = attlevels)
p
# ## horizontal stacked bar graph with custom color.
# p<-ggplot(subset(ds,year==1997), aes(x=1,y=attendPR))
# p<-p+geom_bar(stat="identity")
# p<-p+coord_flip()
# # p<-p+scale_fill_brewer(palette="Pastel1")
# p

```

```{r relprefPR_1997, echo=echoChunks, message=FALSE}
# str(ds$byear)
p<-ggplot(subset(ds,year==1997), aes(x=relprefPR))
p<-p+geom_bar()
p<-p+coord_flip()
p
```

```{r relraisedPR_1997, echo=echoChunks, message=FALSE}
# str(ds$byear)
p<-ggplot(subset(ds,year==1997), aes(x=relraisedPR))
p<-p+geom_bar()
p<-p+coord_flip()
p
```

```{r agemon, echo=echoChunks, message=FALSE}
# str(ds$byear)
timepoints<-1997:2000
for (t in timepoints){
years<-t
for(i in years){
p<-ggplot(subset(ds,year==i), aes(x=agemon))
p<-p+geom_bar(bin=1)
p<-p+xlab(paste0("Age in months"," in ",i)) 
p<-p+ylab("Count")
# p<-p+coord_flip()
}
p
}

```






```{r, echo=echoChunks, message=FALSE}
p<-ggplot(subset(ds,year==1997), aes(x=sample, fill=order(attendPR)))
p<-p+geom_bar(position="fill")
p
```