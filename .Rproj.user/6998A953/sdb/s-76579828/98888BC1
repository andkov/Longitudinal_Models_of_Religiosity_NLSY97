{
    "contents" : "---\ntitle: \"Metrics\"\noutput:\n  pdf_document:\n    fig_caption: no\n    fig_crop: no\n    fig_width: 8\n    latex_engine: xelatex\n    number_sections: yes\n    toc: yes\n    toc_depth: 3\n  md_document:\n    toc: yes\n    toc_depth: 3\n  html_document:\n    css: ~/GitHub/Longitudinal_Models_of_Religiosity_NLSY97/www/css/thesis.css\n    fig.retina: 2\n    fig_width: 8\n    theme: united\n    toc: yes\n  word_document:\n    fig_width: 6.5\nmainfont: Calibri\n---\n\n\n\n<!--  Set the working directory to the repository's base directory; this assumes the report is nested inside of only one directory.-->\n```{r, echo=F, message=F} \nrequire(knitr)\nopts_knit$set(root.dir='../../')  #Don't combine this call with any other chunk -especially one that uses file paths.\n\n```\n\n```{r set_options, echo=F, message=F}\nrequire(knitr)\n# getwd()\nopts_chunk$set(\n  results='show', \n  message = TRUE,\n  comment = NA, \n  tidy = FALSE,\n#   fig.height = 4.8, \n#   fig.width = 6.5, \n  out.width = NULL,\n  fig.path = 'figure_rmd/Metrics/',     \n  dev = \"png\",\n  dpi = 400\n)\nechoChunks <- FALSE\nwarningChunks<- FALSE\noptions(width=120) #So the output is 50% wider than the default.\nread_chunk(\"./Models/Descriptives/Descriptives.R\") # the file to which knitr calls for the chunks\n```\n\nLabeling factors and exploring scales.   \n\n```{r DeclareGlobals, echo=F, message=FALSE, results='hide'}\n# aesDefs\n```\n\n```{r LoadPackages, echo=echoChunks, message=F}\n```\n\n```{r LoadData, echo=echoChunks, message=T}\n# select only respondence in the cross-sectional sample\n\n```\n\n## Data preliminaries\n\nInitial point of departure - the [databox][databox] of the selected variables, described in the Methods chapter.  \n![Figure 3.2](../../images/databox_slice.png)\nThis [databox][databoxStatcanvas] corresponds to the dataset **dsL** produced by [Derive_dsL_from_Extract][derive] report, given in the Appendix.     \n```{r echo=T, message=T}\ndsL<-readRDS(\"./Data/Derived/dsL.rds\")\n```\n![Figure 3.3](./figure_rmd/3_Methods_Figure_3_3.png)     \n\nNote that the variable **year** serves as a natural devided between time invariant (TIvars) and time variant (TVvars) variables. All modeling operations beging with subsetting this dataset.  For the grammer rules of operations with relevant data see [Data Manipulation Guide][manipulate].\n\n\n##  Labeling Factor Levels\nReview of the item reference [cards][databoxStatcanvas] shows that initially, all items were recorded on some discrete scale, either counting occasions or assigning an intiger to a category of response. However, data were saved as numerical values or  intigers\n```{r}\nds<- dsL %>%\n  dplyr::select(\n        sample, id, sex, race, bmonth,byear, attendPR, relprefPR,relraisedPR,\n    year,\n        agemon, ageyear, famrel, attend,\n        values, todo, obeyed, pray, decisions, \n        relpref, bornagain, faith, \n        calm, blue, happy, depressed, nervous,\n        tv, computer, internet)               \nstr(ds)\n```\n\n[LabelingFactorLevels.R][labels] sourced at the end of [Derive_dsL_from_Extract][derive] matches numeric values with response labels from the questionnaire and adds to **dsL** copies of the variables, saved as labeled factors. For estimations routines such as <code>lme4</code> or graphing  functions such as <code>ggplot2</code>, the  data type (string,numeric,  factor) is a meaningful input, so a quick access to both formats frequently proves useful.  It is convenient to think that **dsL** contains only\n```{r}\nncol(dsL)/2\n```\nvariables, but each of them has a double, a labeled factor.\n```{r}\nstr(dsL)\n```\nThis give a certain flexibity in assembling needed dataset quickly and have access to factor labels. One can alternate between the raw metric and labeled factor by adding \"F\" suffix to the end of the variable name:\n```{r}\nds<- dsL %>%\n  dplyr::filter(id==25) %>%\n  dplyr::select(id,byear,year, attend,attendF)\nds\n```\nHaving quick access to factor labels will be especially useful during graph production.\n\n\n## Time metrics : Age, Period, Cohort\nNLSY97 sample includes individuals from five cohorts, born between 1980 and 1984.The following graphics shows how birth cohort, age of respondents, and round of observation are related in NSLY97.  \n![Figure 3.1](../../images/APC_layout.png)\n\n\nNSLY97 contains static (**bmonth**, **byear**) and dynamic (**agemon**, **ageyear**) indicators of age : \n\n```{r age_data_25}\nds<- dsL %>% \n  dplyr::filter(id==25, year %in% c(1997:2011)) %>% \n  dplyr::select(id,byear,bmonthF,year,agemon,ageyear)\nprint(ds)\n```\n\nWhen transforming the metric of time, and using biological age instead of year of measurement as the temporal dimension, the value of age at the time of the interview will be computed as **age** = **agemon**/12  \n\n```{r age_data_25_2}\nds<- dsL %>% \n  dplyr::filter(id==25, year %in% c(1997:2011)) %>% \n  dplyr::select(id,bmonthF,byear,year, agemon,ageyear) %>%\n  dplyr::mutate (age =  agemon/12)\nprint(ds)\n```\n\n## Attendance  \n\nNLSY97 asked to report church attendance (**attend**)for the past 12 months preceding the interview date. The response offered a choice of 7 categories ordered by magnitude.\n```{r attend_2000, echo=echoChunks, message=T, fig.height=3.5,fig.cap=\"Figure caption test\"}\nds<- dsL %>%  dplyr::filter(year==2000,sample==1)\np<-ggplot(ds, aes(x=attendF, fill=attendF))\np <- p + geom_bar(color=\"black\")\np <- p + scale_fill_manual(values=attendCol8, na.value=NACol, guide=FALSE)\np <- p + coord_flip()\n# p <- p + guides(fill = guide_legend(reverse=TRUE, title=\"Attendence\")) #http://www.cookbook-r.com/Graphs/Legends_(ggplot2)/#reversing-the-order-of-items-in-the-legend\np <- p + labs(title=\"How often have you attended a worship service (2000)?\", x=\"Church attendance\", y=\"Count\")\np <- p + ggplot2::theme_bw()\np <- p + ggplot2::theme_bw(base_size=baseSize)\np <- p + ggplot2::theme(title=ggplot2::element_text(colour=\"gray20\",size = 12)) \np <- p + ggplot2::theme(axis.text=ggplot2::element_text(colour=\"gray40\"))\np <- p + ggplot2::theme(axis.title=ggplot2::element_text(colour=\"gray40\"))\np <- p + ggplot2::theme(panel.border = ggplot2::element_rect(colour=\"gray80\"))\np <- p + ggplot2::theme(axis.ticks.length = grid::unit(0, \"cm\"))\np\n\n```\n\n\n\n## Read more \n\nin <code>./Models/Descriptives</code>:   \n\n+ [Metrics][metrics] - how values of items are labeled       \n+ [Descriptives][descriptives] - basic stats of various items (__Continue__)      \n+ [Attendance][attend] - focus on church attendence over time      \n+ [Databox][databox]  \n\nSee also   \n\n+ [Deriving Data from NLYS97 extract][derive]\n+ [Data Manipulation Guide][manipulate]\n\n```{r child, child = 'Citations.Rmd'}\n\n```\n\n",
    "created" : 1404067244183.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3387652407",
    "id" : "98888BC1",
    "lastKnownWriteTime" : 1404106754,
    "path" : "~/GitHub/Longitudinal_Models_of_Religiosity_NLSY97/Models/Descriptives/Metrics.Rmd",
    "project_path" : "Models/Descriptives/Metrics.Rmd",
    "properties" : {
        "tempName" : "Untitled3"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}