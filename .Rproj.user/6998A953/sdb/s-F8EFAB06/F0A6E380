{
    "contents" : "---\ntitle: \"Metrics\"\nauthor: \"Andriy Koval\"\ndate: \"Tuesday, June 24, 2014\"\noutput:\n  html_document:\n    css: ~/GitHub/Longitudinal_Models_of_Religiosity_NLSY97/www/css/thesis.css\n    fig.retina: 2\n    fig_width: 8\n    toc: yes\n  pdf_document:\n    fig_width: 8\n    latex_engine: xelatex\n    toc: yes\n  word_document:\n    fig_width: 6.5\nmainfont: Calibri\n---\n\n\n<!--  Set the working directory to the repository's base directory; this assumes the report is nested inside of only one directory.-->\n```{r, echo=F, message=F} \nrequire(knitr)\nopts_knit$set(root.dir='../../')  #Don't combine this call with any other chunk -especially one that uses file paths.\n\n```\n\n```{r set_options, echo=F, message=F}\nrequire(knitr)\n# getwd()\nopts_chunk$set(\n  results='show', \n  message = TRUE,\n  comment = NA, \n  tidy = FALSE,\n#   fig.height = 4.8, \n#   fig.width = 6.5, \n  out.width = NULL,\n  fig.path = 'figure_rmd/Metrics/',     \n  dev = \"png\",\n  dpi = 400\n)\nechoChunks <- FALSE\nwarningChunks<- FALSE\noptions(width=120) #So the output is 50% wider than the default.\nread_chunk(\"./Models/Descriptives/Descriptives.R\") # the file to which knitr calls for the chunks\n```\n\n#Metrics: labeling factors and exploring scales\n\nReport explains how the response categories from NLSY97 questionnaire are labeled and demonstrates application of labeled factors in data operations and graphing.\n\n```{r DeclareGlobals, echo=echoChunks, message=FALSE}\n# Defined\nattcol8 # color palette for attendance\nbaseSize # base text size\ncolNA # color for the NA value in graphs\n\n```\n\n```{r LoadPackages, echo=echoChunks, message=F}\n```\n\n```{r LoadData, echo=echoChunks, message=T}\n# select only respondence in the cross-sectional sample\n\n```\n\n## Data preliminaries\n\nInitial point of departure - the [databox][1] of the selected variables, described in the [Methods][2] chapter.\n![Figure 3.2](./figure_rmd/3_Methods_Figure_3_2.png)\nThis [databox][1] corresponds to the dataset **dsL** produced by [Derive_dsL_from_Extract][3] report, given in the Appendix. \n```{r echo=T, message=T}\ndsL<-readRDS(\"./Data/Derived/dsL.rds\")\n```\n![Figure 3.3](./figure_rmd/3_Methods_Figure_3_3.png)\n\n\n##  Labeling Factor Levels\nReview of the item reference [cards][1] shows that initially, all items were recorded on some discrete scale, either counting occasions or assigning an intiger to a category of response. However, data were saved as numerical values or  intigers\n```{r}\nds<- dsL[,1:(ncol(dsL)/2)]# selects the first half of variables\nstr(ds)\n```\n[LabelingFactorLevels.R][4] sourced at the end of [Derive_dsL_from_Extract][3] matches numeric values with response labels from the questionnaire and adds to **dsL** copies of the variables, saved as labeled factors. For estimations routines such as <code>lme4</code> or graphing  functions such as <code>ggplot</code>, the  data type (string,numeric,  factor) is a meaningful input, so a quick access to both formats frequently proves useful.  It is convenient to think that **dsL** contains only\n```{r}\nncol(dsL)/2\n```\nvariables, but each of them has a double, a labeled factor.\n```{r}\nstr(dsL)\n```\nThis give a certain flexibity to assemble needed dataset quickly and have access to factor labels. One can alternate between the raw metric and labeled factor by adding \"F\" suffix to the end of the variable name:\n```{r}\nselectCols<-c(\"year\",\"id\",\"byear\",\"attend\",\"attendF\") # select the columns with these names\nds<-dsL[,selectCols] # select all rows for the columns listed  selectCols\nprint(ds[ds$id==1,]) # print all availible data for respondent with ID 1\n```\nHaving quick access to factor labels will be especially useful during graph production. For the grammer rules of operations with relevant data see [Data Manipulation Guide][5].\n\n\n## Time metrics : Age, Period, Cohort\nNLSY97 sample includes individuals from five cohorts, born between 1980 and 1984.The following graphics shows how birth cohort, age of respondents, and round of observation are related in NSLY97.  \n![Figure 3.1](./figure_rmd/3_Methods_Figure_3_1.png)\n\n\nNSLY97 contains static and dynamic indicators of age. Variables  byear and bmonth were recorded once in 1997 (static) and contain respondents’ birth year and birth month respectively. Two age variables were recorded continuously at each interview (dynamic): age at the time of the interview in months (agemon) and in years (ageyear).  \n\n```{r age_data_25}\nds<- dsL %>% dplyr::filter(id==25, year %in% c(1997:2011)) %>% dplyr::select(id,bmonthF,byear,year, agemon,ageyear) %>%\n  mutate (age = (year-byear+1), ageD = agemon/12)\nprint(ds)\n```\n\nThe variable ageyear records the full number of years a respondent reached at the time of the interview. Due to difficulties of administering the survey, time intervals between the waves could differ. For example, for one person id = 25 the age was recorded as 21 years for both 2003 and 2004 (see ageyear). However, when you examine age in months (agemon) you can see this rounding issue disappears, once a more precise scale is used. To avoid this potentially confusing peculiarity, age in years will be calculated as age = year – byear +1 or as (ageD = agemon/12). The suffix D in ageD refers to the fact that it was calculated from a dynamic age indicator. \n\n\n[1]:http://statcanvas.net/thesis/databox/\n[2]:http://statcanvas.net/thesis/III_methods/03_Methods.htm\n[3]:https://github.com/andkov/Longitudinal_Models_of_Religiosity_NLSY97/blob/master/Data/Derive_dsL_from_Extract.md\n[4]:https://github.com/andkov/Longitudinal_Models_of_Religiosity_NLSY97/blob/master/Scripts/Data/LabelingFactorLevels.R\n[5]:https://github.com/andkov/Longitudinal_Models_of_Religiosity_NLSY97/blob/master/Vignettes/dplyr/Data_Manipulation_Guide.md\n",
    "created" : 1403925877617.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3823980906",
    "id" : "F0A6E380",
    "lastKnownWriteTime" : 1403928181,
    "path" : "~/GitHub/Longitudinal_Models_of_Religiosity_NLSY97/Models/Descriptives/Metrics.Rmd",
    "project_path" : "Models/Descriptives/Metrics.Rmd",
    "properties" : {
        "tempName" : "Untitled3"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}