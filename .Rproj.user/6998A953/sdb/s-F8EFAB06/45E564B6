{
    "contents" : "---\ntitle: \"Descriptives\"\nauthor: \"Andriy Koval\"\ndate: \"Tuesday, June 24, 2014\"\noutput:\n  html_document:\n    fig.retina: 2\n    fig_width: 8\n    toc: yes\n    css: ~/GitHub/Longitudinal_Models_of_Religiosity_NLSY97/www/css/thesis.css\n  pdf_document:\n    fig_width: 8\n    latex_engine: xelatex\n    toc: yes\n  word_document:\n    fig_width: 6.5\n  md_document:\n    variant: markdown_github\n    toc: true\n    toc_depth: 3\nmainfont: Calibri\n---\n\n\n<!--  Set the working directory to the repository's base directory; this assumes the report is nested inside of only one directory.-->\n```{r, echo=F, message=F} \nrequire(knitr)\nopts_knit$set(root.dir='../../')  #Don't combine this call with any other chunk -especially one that uses file paths.\n\n```\n\n```{r set_options, echo=F, message=F}\nrequire(knitr)\n# getwd()\nopts_chunk$set(\n  results='show', \n  message = TRUE,\n  comment = NA, \n  tidy = FALSE,\n#   fig.height = 4.8, \n#   fig.width = 6.5, \n  out.width = NULL,\n  fig.path = 'figure_rmd/Descriptives/',     \n  dev = \"png\",\n  dpi = 400\n)\nechoChunks <- FALSE\nwarningChunks<- FALSE\noptions(width=120) #So the output is 50% wider than the default.\nread_chunk(\"./Models/Descriptives/Descriptives.R\") # the file to which knitr calls for the chunks\n```\n\n```{r DeclareGlobals, echo=echoChunks, message=FALSE}\n# Defined\nattcol8 # color palette for attendance\nbaseSize # base text size\ncolNA # color for the NA value in graphs\n\n```\n\n```{r LoadPackages, echo=echoChunks, message=F}\n```\n\n```{r LoadData, echo=echoChunks, message=T}\n# vignette(\"introduction\",package=\"dplyr\") # <- for more info on dplyr\n```\n\nDescriptives:\n===  \nBasic descriptives reports on selected NLSY97 items\n\n# Basic demographics \nAfter importing a clean dataset **dsL** \n\n```{r}\ndsL<-readRDS(\"./Data/Derived/dsL.rds\")\ndplyr::summarize(dsL,N=n_distinct(id))\n```\nrespondents. Of them one (id=467) was removed from the dataset due to abberant age score that seemed as a coding mistake. NLSY97 contains representative household sample and the oversample of racial minorities. \n\n```{r}\nds<- dsL %>% dplyr::group_by(sampleF) %>% summarize (count=n_distinct(id))\nds\n```\n\n\n\n```{r basic_demo,echo=F, warning=F}\nds<- dsL %>% dplyr::filter(id %in% c(1:9000), year==1997) %>% dplyr::select(id,sampleF,sexF, raceF) %>%\n  dplyr::group_by(sampleF, sexF,raceF) %>% dplyr::summarize (count= n()) \n\n# ds<- reshape2::melt(ds,id.vars= colnames(ds))\n# ds\np<- ggplot(ds, aes(x=raceF, y=count, fill=sexF))\n#geoms\np<- p+ geom_bar(stat=\"identity\", position=\"dodge\")\np<- p+ facet_grid(sampleF~.)\np<- p+ geom_text(aes(label=count), position=position_dodge(.9), vjust=-.2, size=3.5)\n# scales\np<- p + scale_y_continuous( limits= c(0,2700))\n# annotations\np<- p + guides(fill = guide_legend( title=\"Sex\")) \np<- p+ labs(title = \"Basic demographic constitution of NLSY97\",\n                         x=\"Race\",\n                         y=\"Sampling frame\")\n# themes\np <- p + ggplot2::theme_bw()\np <- p + ggplot2::theme_bw(base_size=baseSize)\np <- p + ggplot2::theme(title=ggplot2::element_text(colour=\"gray20\",size = 12)) \np <- p + ggplot2::theme(axis.text=ggplot2::element_text(colour=\"gray40\"))\np <- p + ggplot2::theme(axis.title=ggplot2::element_text(colour=\"gray40\"))\np <- p + ggplot2::theme(panel.border = ggplot2::element_rect(colour=\"gray80\"))\np \n\n\n```\n\n# Distribution of age variables\nThe age of respondents was of particular interest and was entered as a predictor of the model outcome. NSLY97 contains static and dynamic indicators of age age. Variables  byear and bmonth were recorded once in 1997 (static) and contain respondentsâ€™ birth year and birth month respectively. Two age variables were recorded continuously at each interview (dynamic): age at the time of the interview in months agemon and in years ageyear.   Next graph shows how births in the NLSY97 sample (static age) was distributed over calendric months from 1980 to 1984:\n\n## Months of births\n```{r bmonth_dist, echo=F, warning=F, fig.height=3.3}\nds<- dsL %>% dplyr::filter(year %in% c(1997)) %>% \n  dplyr::select(id,year,byearF,bmonth,agemon,ageyear) %>%\n  dplyr::group_by(bmonth,byearF) %>%\n  dplyr::summarize(count=n()) %>% arrange(byearF,bmonth) %>%\n  dplyr::mutate (born=paste0(substr(byearF,3,4),\"-\",bmonth)) %>%\n  dplyr::arrange(byearF, bmonth)\nhead(ds, 13)\n\n  p<-ggplot(ds, aes(x=born, y=count, fill=byearF))\n  p<-p+geom_bar(stat=\"identity\")\n  p<- p + scale_fill_manual(values=cohortCol5)\n# annotations\np<- p + guides(fill = guide_legend(reverse=TRUE, title=\"Birth year\")) \np<-  p+ labs(title = \"Distribution of births among NLSY97 repsondent (1997)\",\n                         x=\"The month of birth\",\n                         y=\"Count\")\n# themes\np <- p + ggplot2::theme_bw()\np <- p + ggplot2::theme_bw(base_size=baseSize)\np <- p + ggplot2::theme(title=ggplot2::element_text(colour=\"gray20\",size = 12)) \np <- p + ggplot2::theme(axis.text=ggplot2::element_text(colour=\"gray40\", size=8))\np <- p + ggplot2::theme(axis.title=ggplot2::element_text(colour=\"gray40\"))\np <- p + ggplot2::theme(panel.border = ggplot2::element_rect(colour=\"gray80\"))\np <- p + ggplot2::theme(axis.ticks.length = grid::unit(0, \"cm\"))\np<- p + theme(axis.text.x = element_text(angle=90, hjust=1, vjust=.5))\np\n```\n\n\n## Age and cohort structure \n```{r agemon_dist, echo=F, warning=F, fig.height=3.3}\nds<- dsL %>% dplyr::filter(id %in% c(1:19000), year %in% c(2000)) %>% dplyr::select(id,year,byearF,attend,agemon,ageyear) %>%\n  mutate(time=year-2000, age=agemon/12)\n\n  p<-ggplot(ds, aes(x=agemon, fill=byearF))\n  p<-p+geom_bar(bin=1)\n  p<- p + scale_fill_manual(values=cohortCol5)\n# annotations\np<- p + guides(fill = guide_legend(reverse=TRUE, title=\"Birth year\")) \np<-  p+ labs(title = \"Age and cohort structure\",\n                         x=\"Age in months at the time of interview in 2000\",\n                         y=\"Count\")\n# themes\np <- p + ggplot2::theme_bw()\np <- p + ggplot2::theme_bw(base_size=baseSize)\np <- p + ggplot2::theme(title=ggplot2::element_text(colour=\"gray20\",size = 12)) \np <- p + ggplot2::theme(axis.text=ggplot2::element_text(colour=\"gray40\"))\np <- p + ggplot2::theme(axis.title=ggplot2::element_text(colour=\"gray40\"))\np <- p + ggplot2::theme(panel.border = ggplot2::element_rect(colour=\"gray80\"))\np <- p + ggplot2::theme(axis.ticks.length = grid::unit(0, \"cm\"))\np\n```\n\n===\nRead more in <code>./Models/Descriptives</code>:   \n+ [Descriptives](./Descriptives.md) - basic stats of various items   \n+ [Attendance](./Attendance.md) - focus on church attendence over time   \n+ [Metrics](./Metrics.md) - how values of items are labeled   \n+ [Databox](./Databox.md)   \n\n\n[databox]:http://statcanvas.net/thesis/databox/\n[derive]:https://github.com/andkov/Longitudinal_Models_of_Religiosity_NLSY97/blob/master/Data/Derive_dsL_from_Extract.md\n[labels]:https://github.com/andkov/Longitudinal_Models_of_Religiosity_NLSY97/blob/master/Scripts/Data/LabelingFactorLevels.R\n[manipulate]:https://github.com/andkov/Longitudinal_Models_of_Religiosity_NLSY97/blob/master/Vignettes/dplyr/Data_Manipulation_Guide.md\n",
    "created" : 1403926411913.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "421536985",
    "id" : "45E564B6",
    "lastKnownWriteTime" : 1403933289,
    "path" : "~/GitHub/Longitudinal_Models_of_Religiosity_NLSY97/Models/Descriptives/Descriptives.Rmd",
    "project_path" : "Models/Descriptives/Descriptives.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}