{
    "contents" : "---\ntitle: \"Introduction to LCM\"\noutput:\n  html_document:\n    css: ~/GitHub/Longitudinal_Models_of_Religiosity_NLSY97/www/css/thesis.css\n    fig.retina: 2\n    fig_width: 8\n    theme: united\n    toc: yes\n  md_document:\n    toc: yes\n    toc_depth: 3\n  pdf_document:\n    fig_caption: no\n    fig_crop: no\n    fig_width: 8\n    highlight: tango\n    latex_engine: xelatex\n    number_sections: yes\n    toc: yes\n    toc_depth: 3\n  word_document:\n    fig_width: 6.5\nmainfont: Calibri\nfontsize: 14pt\n---\n\n\n<!--  Set the working directory to the repository's base directory; this assumes the report is nested inside of only one directory.-->\n```{r, echo=F, message=F} \nrequire(knitr)\nopts_knit$set(root.dir='../../')  #Don't combine this call with any other chunk -especially one that uses file paths.\n\n```\n\n```{r set_options, echo=F, message=F}\nrequire(knitr)\n# getwd()\nopts_chunk$set(\n  results='show', \n  message = TRUE,\n  comment = NA, \n  tidy = FALSE,\n#   fig.height = 4.8, \n#   fig.width = 6.5, \n  out.width = NULL,\n  fig.path = 'figure_rmd/IntroLCM/',     \n  dev = \"png\",\n  dpi = 400\n)\nechoChunks <- FALSE\nwarningChunks<- FALSE\noptions(width=120) #So the output is 50% wider than the default.\nread_chunk(\"./Models/Descriptives/Descriptives.R\") # the file to which knitr calls for the chunks\n```\n\n```{r DeclareGlobals, echo=echoChunks, message=FALSE, results='hide'}\n```\n\n```{r LoadPackages, echo=echoChunks, message=F}\n```\n\n```{r LoadData, echo=echoChunks, message=T}\n# rm(list=ls(all=TRUE))  \n# dsL<-readRDS(file.path(getwd(),\"Data/Derived/dsL.rds\"))\n# source(file.path(getwd(),\"Models/Descriptives/AesDefine.R\"))\n\n```\n\nWe can retrieve data for a single person using <code>id</code>\n```{r, echo=T, message=T}\nds<- dsL %>% \n  dplyr::filter(id==1,year %in% c(2000:2011)) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id,year,attend, time) \nprint(ds)\n```\n\n\n```{r, echo=F}\n\nds<- dsL %>% \n  dplyr::filter(id==1,year %in% c(2000:2011)) %>% \n  dplyr::select(id,year,attend,attendF) %>% \n  dplyr::mutate(time=year-2000)\n\n# canvas\np<-ggplot(ds, aes(x=time,y=attend))\n# geoms\np<- p+ geom_point(aes(fill=attendF), size=3.5, shape=21)\np<- p+ geom_line(aes(group=id), alpha=.6, linetype=2, size=.5)\n# scales\np<- p+ scale_fill_manual(values=attendCol8)\np<- p+ scale_y_continuous(\"Church attendance\",\n                     limits=c(0, 8),\n                     breaks=c(1:8))\np<- p+ scale_x_continuous(\"Years since 2000\",\n                   limits=c(0,11),\n                   breaks=c(0:11))\n# annotations\np<- p + labs(title=paste0(\"In the past year, how often have you attended a worship service?\"))\np<- p + guides(fill = guide_legend(reverse=TRUE, title=\"Response category\")) \n# # themes\np<- p + ggplot2::theme_bw()\np<- p + ggplot2::theme_bw(base_size=baseSize)\np<- p + ggplot2::theme(title=ggplot2::element_text(colour=\"gray20\",size = 12)) \np<- p + ggplot2::theme(axis.text=ggplot2::element_text(colour=\"gray40\"))\np<- p + ggplot2::theme(axis.title=ggplot2::element_text(colour=\"gray40\"))\np<- p + ggplot2::theme(panel.border = ggplot2::element_rect(colour=\"gray80\"))\ntrajD <- p + ggplot2::theme(axis.ticks.length = grid::unit(0, \"cm\"))\ntrajD # trajectory from Data\n```\n\nOr enter data manually, if we want to work with artificial trajectories\n```{r}\nds<- dsL %>% \n  dplyr::filter(id==1,year %in% c(2000:2011)) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::mutate(attend= c(6,7,7,6,4,3,2,1,1,1,2,2)) %>%\n  dplyr::select(id,year,attend,time)\n\nattendF=ordered(ds$attend,\n            levels= unique(dsL$attend,is.na=T),\n            labels=levels(dsL$attendF))\nprint(ds)\n```\n\n```{r, echo=F, eval=F}\n# Alternatively, for posting code online\nds <- read.table(header = TRUE, text =\"\nobs  id year attend\n1  47 2000      6\n2  47 2001      7\n3  47 2002      7\n4  47 2003      6\n5  47 2004      5\n6  47 2005      4\n7  47 2006      3\n8  47 2007      2\n9  47 2008      1\n10 47 2009      1\n11 47 2010      2\n12 47 2011      3\n\n\")\nds<- ds %>% dplyr::mutate(time=year-2000)\nprint(ds)\n```\n\n```{r, echo=F}\n# canvas\np<-ggplot(ds, aes(x=time,y=attend))\n# geoms\np<- p+ geom_point(aes(fill=attendF), size=3.5, shape=21)\np<- p+ geom_line(aes(group=id), alpha=.6, linetype=2, size=.5)\n# scales\np<- p+ scale_fill_manual(values=attendCol8)\np<- p+ scale_y_continuous(\"Church attendance\",\n                     limits=c(0, 8),\n                     breaks=c(1:8))\np<- p+ scale_x_continuous(\"Years since 2000\",\n                   limits=c(0,11),\n                   breaks=c(0:11))\n# annotations\np<- p + labs(title=paste0(\"In the past year, how often have you attended a worship service?\"))\np<- p + guides(fill = guide_legend(reverse=TRUE, title=\"Response category\")) \n# # themes\np<- p + ggplot2::theme_bw()\np<- p + ggplot2::theme_bw(base_size=baseSize)\np<- p + ggplot2::theme(title=ggplot2::element_text(colour=\"gray20\",size = 12)) \np<- p + ggplot2::theme(axis.text=ggplot2::element_text(colour=\"gray40\"))\np<- p + ggplot2::theme(axis.title=ggplot2::element_text(colour=\"gray40\"))\np<- p + ggplot2::theme(panel.border = ggplot2::element_rect(colour=\"gray80\"))\ntrajM <- p + ggplot2::theme(axis.ticks.length = grid::unit(0, \"cm\"))\ntrajM # trajectory entered Manually\n```\n\n```{r}\nintercept<- predict(lm(attend ~ 1, ds))\nds<- ds %>% dplyr::mutate(int=intercept)\nprint(ds)\np<-trajM+ geom_line(aes(y=linear),color=\"red\", size=.5)\np\n```\n\n\nadd a straight line to represent possible predition line, in this case a straight line\n```{r c5}\nlinear<- predict(lm(attend ~ time, ds))\nds<- ds %>% dplyr::mutate(linear=linear)\nprint(ds)\np<-p+ geom_line(aes(y=linear),color=\"red\", size=.5)\np\n```\nOr adding the curvarture the  quadratic term\n```{r c6}\nquadratic<- predict(lm(attend ~ poly(time,2),ds))\nds<- ds %>% mutate(quadratic=quadratic)\nprint(ds)\np<-p+ geom_line(aes(y=quadratic),color=\"blue\", size=.5)\n p\n# p<-p+ geom_line(aes(y=cubic),color=\"green\", size=.5)\n```\nor the cubic term\n```{r c7}\ncubic<- predict(lm(attend ~ poly(time,3),ds))\nds<- ds %>% mutate( cubic=cubic)\nprint(ds)\np<-p+ geom_line(aes(y=cubic),color=\"green\", size=.5)\np\n```\n",
    "created" : 1404236703232.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "127|22|147|3|\n",
    "hash" : "1486568467",
    "id" : "BD115A8",
    "lastKnownWriteTime" : 1404261048,
    "path" : "~/GitHub/Longitudinal_Models_of_Religiosity_NLSY97/Models/LCM/IntroLCM.Rmd",
    "project_path" : "Models/LCM/IntroLCM.Rmd",
    "properties" : {
        "tempName" : "Untitled3"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}